This element provides serial and parallel modeling of long range, multi-bunch, multi-pass, non-resonant wakes.
Resonant wakes can be modeled using the \verb|*RFMODE| elements, while short-range wakes are modeled with
\verb|WAKE|, \verb|TRWAKE|, \verb|ZLONGIT|, \verb|ZTRANSVERSE|, and \verb|RFCW|.
At present there is no way to combine short-range and long-range non-resonant wakes in the parallel version
except when there is only a single bunch.

For the \verb|LRWAKE| element, the beam is assumed to be bunched and wakes are computed bunch-to-bunch.
The long-range wake is assumed to be constant within any single bunch.

However, {\tt elegant} doesn't have the concept of a beam with multiple bunches.
In particular, domain decomposition in the parallel version doesn't recognize a
bunch property of the particles.
Rather than try to add this (a major change that would potentially limit the number of processors used), we used a simpler technique
\begin{itemize}
\item The user declares how many buckets $B$ to use for grouping particles.
\item {\tt elegant} determines the inter-bucket spacing from the circumference.
\item Each processor uses arrays to record
\begin{itemize}
  \item How many particles are in each bucket,
  \item The sum of the arrival times $t$ at the LRWAKE element for the particles in each bucket, and
  \item The sum of x and y at the LRWAKE element for the particles in each bucket.
  \end{itemize}
\item These arrays are summed across all the processors and used to compute the moments
  $\langle t \rangle$, $\langle x \rangle$, and $\langle y \rangle$ for each bunch, as
  well as the charge in each bunch.
\item Arrays of length $B$ from $N$ prior turns are kept in a buffer
  \begin{itemize}
  \item Buffer for turns $N-1$ to $1$ is copied to slots $N$ through $2$, thus overwriting the data for
    the oldest turn.
  \item The data for latest turn is copied into slot 1.
  \end{itemize}
\item  For each bunch, sums are performed over all prior buckets/turns to compute the voltage. For the 
  longitudinal wake, we have
  \begin{equation}
    V_z(b) = \sum\limits_{i=b}^{N*B} q_i W_z(\langle t_b \rangle - \langle t_i \rangle)
  \end{equation}
while for the horizontal wake we have
  \begin{equation}
    V_x(b) = \sum\limits_{i=b}^{N*B} q_i \langle x_i \rangle W_x(\langle t_b \rangle - \langle t_i \rangle),
  \end{equation}
with the vertical wake being similar.
\end{itemize}

To use LRWAKE, the user provides the wakes (functions of t) in an SDDS file.
These wakes may extend over an arbitrary number of turns, with the user declaring how many turns
to actually use as part of the element definition.
However, they should be zero within the region occupied by a single bunch, to avoid
double-counting with the true short-range wake.
(Note that the above sums include the self-wake.)
Similarly, the short-range should be zero for times comparable to the bunch spacing.
